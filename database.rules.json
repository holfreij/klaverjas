{
	"rules": {
		"lobbies": {
			"$lobbyCode": {
				".read": "auth != null",
				".write": "auth != null && (!data.exists() || data.child('players').child(auth.uid).exists())",
				"code": {
					".validate": "newData.isString() && newData.val().length == 6"
				},
				"host": {
					".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 60"
				},
				"createdAt": {
					".validate": "newData.isNumber()"
				},
				"status": {
					".validate": "newData.isString() && (newData.val() === 'waiting' || newData.val() === 'playing' || newData.val() === 'finished')"
				},
				"players": {
					"$playerId": {
						".write": "auth != null && $playerId === auth.uid",
						"name": {
							".validate": "newData.isString() && newData.val().length >= 3 && newData.val().length <= 50"
						},
						"seat": {
							".validate": "(newData.isNumber() && newData.val() >= 0 && newData.val() <= 3) || newData.val() === 'table'"
						},
						"connected": { ".validate": "newData.isBoolean()" },
						"lastSeen": { ".validate": "newData.isNumber()" },
						"$other": { ".validate": false }
					}
				},
				"game": {
					".validate": "!newData.exists() || newData.hasChildren(['phase', 'round', 'trick', 'dealer'])"
				},
				"$other": { ".validate": false }
			}
		}
	}
}
